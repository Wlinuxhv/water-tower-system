# 低功耗水塔监控系统 - 开发任务

## 目标

1. ✅ ESP8266 主机适配 PAN3031 无线模块
2. ✅ ESP8266 实现 Web 服务器
3. ✅ ESP8266 实现自动水位控制
4. 🔲 从机改用 STC8G1K08 (8KB Flash) 降低成本
5. 🔲 从机实现低功耗模式 (电池供电)
6. 🔲 PAN3031 低功耗配置

## 硬件架构

### 主机 (ESP8266 + PAN3031)
- ESP8266 NodeMCU
- PAN3031 LoRa 模块 (SPI)
- OLED 显示屏 (I2C)
- 缺水传感器 (GPIO)
- WiFi → 手机 APP

### 从机 (STC8G1K08 + PAN3031)
- STC8G1K08 (8KB Flash, 512B RAM)
- PAN3031 LoRa 模块 (SPI)
- 液位传感器 (ADC)
- 水泵继电器 (GPIO)
- 缺水传感器 (GPIO)
- **低功耗设计**: 睡眠电流 < 10μA

## 关键改进点

### 1. PAN3031 低功耗
- 睡眠模式配置
- 定时唤醒
- WOR (Watch On Receiver) 功能

### 2. STC8G1K08 低功耗
- 空闲模式
- 睡眠模式
- 外部中断唤醒

### 3. 通信协议优化
- 从机定时发送 (减少监听)
- 主机广播唤醒
- 数据包精简

## 成本对比

| 方案 | MCU | 成本 | 功耗 |
|------|-----|------|------|
| 旧方案 | STC32G12K128 | ¥35 | ~5mA |
| 新方案 | STC8G1K08 | ¥8-10 | <10μA (睡眠) |

**每从机节省**: ¥25+  
**4 从机系统节省**: ¥100+
